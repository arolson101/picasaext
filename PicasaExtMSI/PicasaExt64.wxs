<?xml version="1.0" encoding="utf-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
    <Product Name="PicasaExt" Id="F70B9797-4BA0-4897-99BC-3EBA04816474" UpgradeCode="1DAD09A0-F380-45cf-86B6-8B5EFB7E388D" Language="1033" Codepage="1252" Version="1.0.0" Manufacturer="PicasaExt">
        <Package Id="*" Keywords="Installer" Description="PicasaExt 1.0 Installer" Comments="PicasaExt is not made, endorsed, or supported by Google." InstallerVersion="200" Languages="1033" Compressed="yes" SummaryCodepage="1252" Platform="x64" />
        <Condition Message="You need to be an administrator to install this product.">Privileged</Condition>
        <Condition Message="This installer is only for 64-bit Windows">VersionNT64</Condition>
        <Media Id="1" Cabinet="PicasaExt.cab" EmbedCab="yes" />
        <Property Id="APPID">{3D38C35E-34B7-476D-837D-6F2A33AE2281}</Property>
        <Property Id="CLSID">{8218849A-80B4-4231-AD8A-5167F27D2F6F}</Property>
        <Directory Id="TARGETDIR" Name="SourceDir">
            <Directory Id="ProgramFiles64Folder" Name="PFiles">
                <Directory Id="INSTALLDIR" Name="PicasaExt">
                    <Component Win64="yes" Id="ComponentPicasaExt32" Guid="B71FD519-6E0C-417e-BF18-DD66CE5E75A7">
                        <File Id="PicasaExtDLL32" Name="PicasaExt32.dll" DiskId="1" Source="..\Release\PicasaExt\Win32\PicasaExt.dll" KeyPath="yes" />
                        <RegistryValue Root="HKCR" Key="Wow6432Node\AppID\[APPID]" Value="PicasaExt" Action="write" Type="string" />
                        <RegistryValue Root="HKCR" Key="Wow6432Node\AppID\PicasaExt.DLL" Name="AppID" Value="[APPID]" Action="write" Type="string" />
                        <RegistryValue Root="HKCR" Key="Wow6432Node\CLSID\[CLSID]" Value="PicasaStarIcon Class" Action="write" Type="string" />
                        <RegistryValue Root="HKCR" Key="Wow6432Node\CLSID\[CLSID]\InprocServer32" Value="[INSTALLDIR]PicasaExt32.dll" Action="write" Type="string" />
                        <RegistryValue Root="HKCR" Key="Wow6432Node\CLSID\[CLSID]\InprocServer32" Name="ThreadingModel" Value="Apartment" Action="write" Type="string" />
                        <RegistryValue Root="HKCR" Key="Wow6432Node\CLSID\[CLSID]\Programmable" Value="" Action="write" Type="string" />
                        <RegistryValue Root="HKLM" Key="SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Explorer\ShellIconOverlayIdentifiers\PicasaStarIcon" Value="[CLSID]" Action="write" Type="string" />
                    </Component>
                    <Component Win64="yes" Id="ComponentPicasaExt64" Guid="A1E1C5D3-B76F-4d88-A297-4B40760CFF50">
                        <File Id="PicasaExtDLL64" Name="PicasaExt64.dll" DiskId="1" Source="..\Release\PicasaExt\x64\PicasaExt.dll" KeyPath="yes" />
                        <RegistryValue Root="HKCR" Key="AppID\[APPID]" Value="PicasaExt" Action="write" Type="string" />
                        <RegistryValue Root="HKCR" Key="AppID\PicasaExt.DLL" Name="AppID" Value="[APPID]" Action="write" Type="string" />
                        <RegistryValue Root="HKCR" Key="CLSID\[CLSID]" Value="PicasaStarIcon Class" Action="write" Type="string" />
                        <RegistryValue Root="HKCR" Key="CLSID\[CLSID]\InprocServer32" Value="[INSTALLDIR]PicasaExt64.dll" Action="write" Type="string" />
                        <RegistryValue Root="HKCR" Key="CLSID\[CLSID]\InprocServer32" Name="ThreadingModel" Value="Apartment" Action="write" Type="string" />
                        <RegistryValue Root="HKCR" Key="CLSID\[CLSID]\Programmable" Value="" Action="write" Type="string" />
                        <RegistryValue Root="HKLM" Key="SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ShellIconOverlayIdentifiers\PicasaStarIcon" Value="[CLSID]" Action="write" Type="string" />
                    </Component>
                </Directory>
            </Directory>
        </Directory>
        <Feature Id="FeaturePicasaExt64bit" Level="1">
            <ComponentRef Id="ComponentPicasaExt32" />
            <ComponentRef Id="ComponentPicasaExt64" />
        </Feature>
        <UI />
        <Property Id="WIXUI_INSTALLDIR" Value="INSTALLDIR" />
        <UIRef Id="WixUI_InstallDir" />
        <WixVariable Id="WixUIBannerBmp" Value="Bitmaps\bannrbmp.bmp" />
        <WixVariable Id="WixUILicenseRtf" Value="lgpl.rtf" />
    </Product>
</Wix>